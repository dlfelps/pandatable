(function(){"use strict";const t="src/offscreen/index.html";async function n(){await chrome.offscreen.hasDocument?.()||await chrome.offscreen.createDocument({url:t,reasons:[chrome.offscreen.Reason.WORKERS||"WORKERS"],justification:"Run Pyodide in a Web Worker for data processing"})}chrome.runtime.onMessage.addListener((e,r,o)=>{if(e.type==="RUN_PYTHON")return(async()=>{try{await n();const a=await chrome.runtime.sendMessage({target:"offscreen",data:{type:"RUN_CODE",code:e.code,data:e.data}});o(a)}catch(a){o({type:"ERROR",error:a.message})}})(),!0}),chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>console.error(e)),chrome.webNavigation.onBeforeNavigate.addListener(e=>{if(e.frameId===0){const r=`tab_${e.tabId}`;chrome.storage.session.get(r,o=>{if(o[r]){const a={...o[r],tables:[],selectedTableId:""};chrome.storage.session.set({[r]:a})}})}}),console.log("Background Service Worker loaded")})();
