(function(){"use strict";const n="src/offscreen/index.html";async function s(){await chrome.offscreen.hasDocument?.()||await chrome.offscreen.createDocument({url:n,reasons:[chrome.offscreen.Reason.WORKERS||"WORKERS"],justification:"Run Pyodide in a Web Worker for data processing"})}chrome.runtime.onMessage.addListener((o,t,r)=>{if(o.type==="RUN_PYTHON")return(async()=>{try{await s();const e=await chrome.runtime.sendMessage({target:"offscreen",data:{type:"RUN_CODE",code:o.code,data:o.data}});r(e)}catch(e){r({type:"ERROR",error:e.message})}})(),!0}),chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(o=>console.error(o)),chrome.tabs.onUpdated.addListener((o,t,r)=>{if(t.status==="loading"){const e=`tab_${o}`;chrome.storage.session.get(e,a=>{if(a[e]){const c={...a[e],tables:[],selectedTableId:""};chrome.storage.session.set({[e]:c})}})}}),console.log("Background Service Worker loaded")})();
